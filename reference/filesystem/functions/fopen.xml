<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 1.25 Maintainer: freespace Status: ready -->
<!-- $Revision: 1.7 $ -->
<!-- splitted from ./en/functions/filesystem.xml, last change in rev 1.2 -->
  <refentry xml:id="function.fopen" xmlns="http://docbook.org/ns/docbook">
   <refnamediv>
    <refname>fopen</refname>
    <refpurpose>Открывает файл или URL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Описание</title>
     <methodsynopsis>
      <type>resource</type><methodname>fopen</methodname>
      <methodparam><type>string</type><parameter>filename</parameter></methodparam>
      <methodparam><type>string</type><parameter>mode</parameter></methodparam>
      <methodparam choice="opt"><type>bool</type><parameter>use_include_path</parameter></methodparam>
      <methodparam choice="opt"><type>resource</type><parameter>zcontext</parameter></methodparam>
     </methodsynopsis>
    <simpara>
     <function>fopen</function> закрепляет именованый ресурс, указанный
     в аргументе <parameter>filename</parameter>, за потоком.  Если
     <parameter>filename</parameter> передан в форме "scheme://...",
     он считается URL'ом и PHP проведёт поиск обработчика протокола
     (также известного как "обвёртка") для этой схемы. Если ни одна
     обвёртка не закреплена за протоколом, PHP выдаст замечание
     чтобы помочь вам отследить потенциальную проблему в вашем
     скрипте и продолжит выполнение, будто <parameter>filename</parameter>
     указывает на обыкновенный файл.
    </simpara>
    <simpara>
     Если PHP решил, что <parameter>filename</parameter> указывает на
     локальный файл, тогда он попытается открыть поток к этому файлу.
     Файл должен быть доступен PHP, так что вам следует убедиться,
     что права доступа на файл разрешают это.
     Если вы вкдючили &safemode;
     или <link linkend="ini.open-basedir">open_basedir</link>, накладываются
     дальнейшие ограничения.
    </simpara>
    <simpara>
     Если PHP решил, что <parameter>filename</parameter> указывает на
     зарегистрированный протокол и этот протокол зарегистрирован как
     сетевой URL, PHP проверит состояние директивы
     <link linkend="ini.allow-url-fopen">allow_url_fopen</link>.
     Если она выключена, PHP выдаст предупреждение и вызов fopen закончится
     неудачей.
    </simpara>
    <note>
     <simpara>
      Список поддерживаемых протоколов доступен в разделе <xref linkend="wrappers"/>.
      Некоторые протоколы (<literal>обвёртки</literal>) поддерживают
      <literal>context</literal> и/или опции &php.ini;.
      Обратитесь к соответствующей странице с описанием используемого протокола
      для получения списка опций, которые могут быть установлены.
      (например, значение &php.ini; <literal>user_agent</literal> используется
      обвёрткой <literal>http</literal>).
      Для получения описания параметров <literal>contexts</literal> и
      <parameter>zcontext</parameter>, обратитесь к разделу <xref linkend="ref.stream"/>.
     </simpara>
    </note>
    &note.context-support;
    <note>
     <simpara>
      Начиная с версии PHP 4.3.2, бинарный режим является режимом по умолчанию
      для всех платформ, которые различают бинарный и текстовый, режимы. Если
      у вас возникли проблемы после обновления, попробуйте использовать флаг
      <literal>'t'</literal> в качестве обходного пути до тех пор, пока вы не
      измените свои скрипты для достижения большей портируемости, как отмечено
      выше.
     </simpara>
    </note>
    <para>
     Параметр <parameter>mode</parameter> указывает тип доступа, который вы
     запрашиваете у потока. Он может быть одним из следующих:
     <table>
      <title>
       Список возможных режимов для <function>fopen</function> 
       используя <parameter>mode</parameter>
      </title>
      <tgroup cols="2">
       <thead>
        <row>
         <entry><parameter>mode</parameter></entry>
         <entry>Описание</entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry><literal>'r'</literal></entry>
         <entry>
          Открывает файл только для чтения; помещает указатель
          в начало файла.
         </entry>
        </row>
        <row>
         <entry><literal>'r+'</literal></entry>
         <entry>
          Окрывает файл для чтения и записи; помещяет указатель
          в начало файла.
         </entry>
        </row>
        <row>
         <entry><literal>'w'</literal></entry>
         <entry>
          Открывает файл только для записи; помещает указатель
          в начало файла и обрезает файл до нулевой длинны.
          Если файл не существует - пробует его создать.
         </entry>
        </row>
        <row>
         <entry><literal>'w+'</literal></entry>
         <entry>
          Открывает файл для чтения и записи; помещает указатель
          в начало файла и обрезает файл до нулевой длинны.
          Если файл не существует - пробует его создать.
         </entry>
        </row>
        <row>
         <entry><literal>'a'</literal></entry>
         <entry>
          Открывает файл только для записи; помещает указатель в конец
          файла. Если файл не существует - пытается его создать.
         </entry>
        </row>
        <row>
         <entry><literal>'a+'</literal></entry>
         <entry>
          Открывает файл для чтения и записи; помещает указатель в конец
          файла. Если файл не существует - пытается его создать.
         </entry>
        </row>
        <row>
         <entry><literal>'x'</literal></entry>
         <entry>
          Создаёт и открывает только для записи; помещает указатель в
          начало файла. Если файл уже существует, вызов
          <function>fopen</function> закончится неудачей, вернёт &false; и
          выдаст предупреждение уровня <constant>E_WARNING</constant>.
          Если файл не существует, попытается его создать. Это эквивалентно
          указанию флагов <literal>O_EXCL|O_CREAT</literal> для внутреннего
          системного вызова <literal>open(2)</literal>. Эта опция
          поддерживается начиная с версии PHP 4.3.2 и выше, и работает только
          для локальных файлов.
         </entry>
        </row>
        <row>
         <entry><literal>'x+'</literal></entry>
         <entry>
          Создаёт и открывает для чтения и записи; помещает указатель в
          начало файла. Если файл уже существует, вызов
          <function>fopen</function> закончится неудачей, вернёт &false; и
          выдаст предупреждение уровня <constant>E_WARNING</constant>.
          Если файл не существует, попытается его создать. Это эквивалентно
          указанию флагов <literal>O_EXCL|O_CREAT</literal> для внутреннего
          системного вызова <literal>open(2)</literal>. Эта опция
          поддерживается начиная с версии PHP 4.3.2 и выше, и работает только
          для локальных файлов.
         </entry>
        </row>
       </tbody>
      </tgroup>
     </table>
    </para>
    <note>
     <para>
      Разные семейства операционных систем имеют разные соглашения
      относительно окончанийя строк. Когда вы пишете текст и хотите вставить
      разрыв строки, вы должны использовать правильный(-ые) символ(ы) для
      вашей операционной системы. Системы семейства Unix используют
      <literal>\n</literal> в качестве символа конца строки, системы
      семейства Windows используют <literal>\r\n</literal> в качестве
      символов окончания строки и системы семейства Macintosh используют
      <literal>\r</literal> в качестве символа конца строки.
     </para>
     <para>
      Если вы используете неверный символ конца строки при редактировании
      файлов, вы можете обнаружить, что при открытии эти файлы "смешно
      выглядят".
     </para>
     <para>
      Windows предлагает флаг режима текстовой трансляции
      (<literal>'t'</literal>), который автоматически переведёт
      <literal>\n</literal> во время работы с файлом.
      И наоборот - также вы можете использовать <literal>'b'</literal> чтобы
      принудительно включить бинарный (двоичный) режим, в котором ваши данные
      не будут преобразовываться. Чтобы использовать эти режимы, укажите
      <literal>'b'</literal> или <literal>'t'</literal> в качестве последней
      буквы параметра <parameter>mode</parameter>.
     </para>
     <para>
      Так как установка флага трансляции по умолчанию зависит от SAPI и версии
      PHP, которую вы используете, рекомендуем явно задавать указанный флаг
      из соображений портируемости. Вы должны использовать режим
      <literal>'t'</literal> если вы работаете с текстовым файлом и
      использовать <literal>\n</literal> для разделения для обозначения
      конца строки в вашем скрипте, при этом не беспокоясь за читаемость
      ваших файлов в других приложениях типа "Блокнота". В противном
      случае вам следует использовать флаг <literal>'b'</literal>.
     </para>
     <para>
      Если вы явно не укажете флаг 'b' во время работы с бинарными файлами,
      вы можете столкнуться со странной порчей ваших данных, включая
      испорченные файлы изображений и странные проблемы с символами
      <literal>\r\n</literal>.
     </para>
    </note>
    <note>
     <para>
      Из соображений портируемости, настоятельно рекомендуется всегда
      использовать флаг 'b' при открытии файлов с помощью
      <function>fopen</function>.
     </para>
    </note>
    <note>
     <para>
      Кроме того, из соображений портируемости, также настойчиво
      рекомендуется переписать старый код, который полагается на режим
      <literal>'t'</literal>, чтобы вместо этого он использовал правильные
      окончания строк и режим <literal>'b'</literal>.
     </para>
    </note>
    <para>
     Необязательный третий параметр <parameter>use_include_path</parameter>
     может быть установлен в '1' или &true;, если вы также хотите провести
     поиск файла в <link linkend="ini.include-path">include_path</link>.
    </para>
    <simpara>
     Если открыть файл не удалось, функция вернёт &false; и сгенерирует ошибку
     уровня <constant>E_WARNING</constant>. Вы можете использовать
     <link linkend="language.operators.errorcontrol">@</link> для того,
     чтобы подавить это предупреждение.
    </simpara>
    <para>
     <example>
      <title>Примеры использования функции <function>fopen</function></title>
      <programlisting role="php">
<![CDATA[
<?php
$handle = fopen("/home/rasmus/file.txt", "r");
$handle = fopen("/home/rasmus/file.gif", "wb");
$handle = fopen("http://www.example.com/", "r");
$handle = fopen("ftp://user:password@example.com/somefile.txt", "w");
?>
]]>
      </programlisting>
     </example>
    </para>
    <simpara>
     Если вы сталкиваетесь с проблемами во время чтения или записи
     файлов, и вы используете PHP в виде серверного модуля, убедитесь
     в том, что процесс сервера имеет доступ к файлам и директориям,
     которые вы используете.
    </simpara>
    <para>
     На платформе Windows, вам необходимо не забывать экранировать все
     обратные слеши в пути к файлу или использовать прямые слеши.
     <informalexample>
      <programlisting role="php"> 
<![CDATA[
<?php
$handle = fopen("c:\\data\\info.txt", "r");
?>
]]>
      </programlisting>
     </informalexample>
    </para>
    &warn.ssl-non-standard;
    &note.sm.uidcheck.dir;
    <simpara>
     См. также раздел <xref linkend="wrappers"/>,
     описание функций <function>fclose</function>,
     <function>fgets</function>, 
     <function>fread</function>,
     <function>fwrite</function>,
     <function>fsockopen</function>,
     <function>file</function>,
     <function>file_exists</function>,
     <function>is_readable</function>,
     <function>stream_set_timeout</function> и
     <function>popen</function>.
    </simpara>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
